<div class ="modal-header">
  <h5 class="modal-title">DETAIL DE LA DIVISION</h5>
  <button type="button" class="close" data-dismiss="modal" aria-label="close">
          <span aria-hidden="true">&times;</span>
  </button>
</div>

<div class="modal-body">
  COTE : <strong class = "cote">{{division.cote}}</strong>
  <h5>NOM : {{division.nom}}</h5>
</div>


<div class="modal-footer">
<a href="#" class="btn btn-primary update_division"><i class="fa fa-info"></i> MODIFIER</a>
<a href="#" class="btn btn-danger delete_division"><i class="fa fa-info"></i> SUPPRIMER</a>
<a href="#" class="btn btn-success add_archive"><i class="fa fa-info"></i> Ajouter une archive</a>
</div>


<script type="text/javascript">

    $('.update_division').on('click' , function(){
        var el = $('#modal-detaildivision .cote')
        var cote= $(el).text()
        $.ajax({
            url:'/repertoire/division/'+ cote + '/update',
            type:'get',
            datatype:'json',
            beforeSend: function(){
                $('#modal-detaildivision').modal('hide');
                $('#modal-division-update').modal('show');
            },
            success: function(data){
                $('#modal-division-update .modal-content').html(data.html);
            }
        });
    });

    $('#modal-division-update').one('submit', '.form-update-division', function(e){
        e.preventDefault();
        var form = $(this);
        $.ajax({
            url : form.attr('data-url'),
            data: form.serialize(),
            type: form.attr('method'),
            dataType:'json',
            success: function(data){

                $('#modal-division-update').modal('hide');
            }

        });
           return false;
    });


   $('.add_archive').on('click' , function(){
	  var el = $('#modal-detaildivision .cote')
      var cote= $(el).text()
      $.ajax({
         url:'/repertoire/division/'+cote+'/add/archive',
         type:'get',
         datatype:'json',
         beforeSend: function(){
             $('#modal-detaildivision').modal('hide');
             $('#modal-archives').modal('show');
         },
         success: function(data){
             $('#modal-archives .modal-content').html(data.html_form);
         }
      });
    });

    $('#modal-archives').one('submit', '.add-archive', function(e){
        e.preventDefault();
        var form = $(this);
        $.ajax({
            url : form.attr('data-url'),
      		data: form.serialize(),
      		type: form.attr('method'),
      		dataType:'json',
      		success: function(data){
        		$('#modal-archives').modal('hide');
      		}
    	});
    	return false;
  	});


    $('.delete_division').on('click' , function(){
        var el = $('#modal-detaildivision .cote')
        var cote = $(el).text()
        $.ajax({
            url:'/repertoire/division/'+ cote +'/delete',
            type:'get',
            datatype:'json',
            beforeSend: function(){
   		        $('#modal-detaildivision').modal('hide');
                $('#modal-delete-division').modal('show');
            },
            success: function(data){
                $('#modal-delete-division .modal-content').html(data.html);
            }
        });
    });

    $('#modal-delete-division').one('submit', '.form-delete-division', function(){
        var form = $(this);
        $.ajax({
            url : form.attr('data-url'),
            data: form.serialize(),
            type: form.attr('method'),
            dataType:'json',
            success: function(data){
               	$('#modal-delete-division').modal('hide');
            } 
        });
            return false;
    });
          
</script>